{"ast":null,"code":"var _jsxFileName = \"c:\\\\Users\\\\yangzhuo_sx\\\\Desktop\\\\GDOM\\\\GDOM\\\\gdom\\\\src\\\\components\\\\accountManage\\\\accountManage.js\";\nimport React, { Component } from 'react';\nimport { Tag, Button, Input, Alert } from 'antd';\nimport './accountManage.css';\nimport ajaxParam from '../../api/ajaxParam';\nimport ajax from '../../api/ajax';\nimport qs from 'qs'; // import { format } from 'url';\n\nexport class accountManage extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      uid: '',\n      name: '',\n      cno: '',\n      mobile: '',\n      isError: false,\n      code: '',\n      oldPwd: '',\n      newPwd: '',\n      isShowChangeMobile: false,\n      isShowChangePwd: false\n    };\n\n    this.componentWillMount = () => {\n      this.setState({\n        uid: this.props.uid\n      });\n    };\n\n    this.componentDidMount = () => {\n      const _this$state = this.state,\n            uid = _this$state.uid,\n            dataKey = _this$state.dataKey;\n      const data = {\n        \"uid\": uid\n      };\n\n      const reqResult = data => ajaxParam('http://47.94.103.140/gdom/user/selfinfo', qs.stringify(data), 'post');\n\n      reqResult(data).then(res => {\n        const data = res.data;\n        this.setState({\n          name: data.userInfo.username,\n          mobile: data.userInfo.mobile\n        });\n      }).catch(err => {\n        console.log(err);\n      });\n    };\n\n    this.setMobile = e => {\n      e.preventDefault();\n      this.setState({\n        mobile: e.target.value\n      });\n    };\n\n    this.setCode = e => {\n      e.preventDefault();\n      this.setState({\n        code: e.target.value\n      });\n    };\n\n    this.setOldPwd = e => {\n      e.preventDefault();\n      this.setState({\n        oldPwd: e.target.value\n      });\n    };\n\n    this.setNewPwd = e => {\n      e.preventDefault();\n      this.setState({\n        newPwd: e.target.value\n      });\n    };\n\n    this.showChangeMobile = () => {\n      this.setState(prevState => ({\n        isShowChangeMobile: !prevState.isShowChangeMobile\n      }));\n    };\n\n    this.showChangePwd = () => {\n      this.setState(prevState => ({\n        isShowChangePwd: !prevState.isShowChangePwd\n      }));\n    };\n\n    this.changePwd = () => {\n      const uid = this.state.uid;\n      const oldPwd = this.state.oldPwd;\n      const newPwd = this.state.newPwd;\n      const data = {\n        \"uid\": uid,\n        \"oldpwd\": oldPwd,\n        \"newpwd\": newPwd\n      };\n\n      const reqResult = data => ajaxParam('http://47.94.103.140/gdom/user/resetpwd', qs.stringify(data), 'post');\n\n      reqResult(data).then(res => {\n        if (res.status === 200) {\n          alert('重置成功');\n        } else {\n          alert('重置失败');\n        } // console.log(res)\n\n      }).catch(err => {\n        console.log(err);\n      });\n    };\n\n    this.changeMobile = () => {\n      const uid = this.state.uid;\n      const code = this.state.code;\n      const mobile = this.state.mobile;\n      const data = {\n        \"uid\": uid,\n        \"mobile\": mobile,\n        \"code\": code\n      };\n\n      const reqResult = data => ajaxParam('http://47.94.103.140/gdom/user/bindmobile', qs.stringify(data), 'post');\n\n      reqResult(data).then(res => {\n        // console.log(res)\n        alert(res.data);\n      }).catch(err => {\n        console.log(err);\n      });\n    };\n\n    this.getCode = () => {\n      const mobile = this.state.mobile; // 请求获取短信验证码的接口\n\n      const data = {\n        \"mobile\": mobile\n      };\n\n      const reqResult = data => ajax('http://47.94.103.140/gdom/login/message', qs.stringify(data), 'post');\n\n      reqResult(data).then(res => {\n        if (res.data === 'success') {// console.log(res)\n        }\n      }).catch(err => {\n        console.log(err);\n      });\n      console.log(\"短信验证\");\n    };\n  }\n\n  render() {\n    const _this$state2 = this.state,\n          name = _this$state2.name,\n          cno = _this$state2.cno,\n          mobile = _this$state2.mobile,\n          isShowChangeMobile = _this$state2.isShowChangeMobile,\n          isError = _this$state2.isError,\n          isShowChangePwd = _this$state2.isShowChangePwd;\n    return React.createElement(\"div\", {\n      className: \"content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"name-con\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"name\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }, \"\\u59D3\\u540D\\uFF1A\", name)), React.createElement(\"div\", {\n      className: \"telephone\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132\n      },\n      __self: this\n    }, \"\\u624B\\u673A\\u53F7\\uFF1A\", mobile ? mobile : '未绑定手机号'), React.createElement(Button, {\n      onClick: this.showChangeMobile,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133\n      },\n      __self: this\n    }, mobile ? '修改' : '绑定')), isShowChangeMobile ? React.createElement(\"div\", {\n      className: \"change-mobile\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135\n      },\n      __self: this\n    }, React.createElement(Input, {\n      placeholder: \"\\u8BF7\\u8F93\\u5165\\u624B\\u673A\\u53F7...\",\n      className: \"InpNumber\",\n      onChange: this.setMobile,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"getCode\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137\n      },\n      __self: this\n    }, React.createElement(Input, {\n      placeholder: \"\\u8BF7\\u8F93\\u5165\\u9A8C\\u8BC1\\u7801\",\n      className: \"Inp\",\n      size: 'large',\n      onChange: this.setCode,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138\n      },\n      __self: this\n    }), React.createElement(Button, {\n      type: \"primary\",\n      ref: \"but\",\n      className: \"btn-pwd\",\n      size: 'large',\n      onClick: this.getCode,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139\n      },\n      __self: this\n    }, \"\\u83B7\\u53D6\\u77ED\\u4FE1\\u9A8C\\u8BC1\\u7801\")), React.createElement(Button, {\n      type: \"primary\",\n      onClick: this.changeMobile,\n      style: {\n        width: \"300px\"\n      },\n      size: 'large',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141\n      },\n      __self: this\n    }, \"\\u91CD\\u7F6E\\u624B\\u673A\\u53F7\"), isError ? React.createElement(Alert, {\n      message: \"Error\",\n      description: \"\\u9A8C\\u8BC1\\u5931\\u8D25\\uFF0C\\u8BF7\\u91CD\\u65B0\\u9A8C\\u8BC1\",\n      type: \"error\",\n      showIcon: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142\n      },\n      __self: this\n    }) : null) : null, React.createElement(Button, {\n      type: \"primary\",\n      size: 'large',\n      onClick: this.showChangePwd,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150\n      },\n      __self: this\n    }, \"\\u5BC6\\u7801\\u91CD\\u7F6E\"), isShowChangePwd ? React.createElement(\"div\", {\n      className: \"change-pwd\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151\n      },\n      __self: this\n    }, React.createElement(Input.Password, {\n      placeholder: \"\\u8BF7\\u8F93\\u5165\\u65E7\\u5BC6\\u7801...\",\n      onChange: this.setOldPwd,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152\n      },\n      __self: this\n    }), React.createElement(Input.Password, {\n      placeholder: \"\\u8BF7\\u8F93\\u5165\\u65B0\\u5BC6\\u7801...\",\n      className: \"inp-pwd\",\n      onChange: this.setNewPwd,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153\n      },\n      __self: this\n    }), React.createElement(Button, {\n      type: \"primary\",\n      size: 'large',\n      onClick: this.changePwd,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154\n      },\n      __self: this\n    }, \"\\u91CD\\u7F6E\\u5BC6\\u7801\")) : null);\n  }\n\n}\nexport default accountManage;","map":{"version":3,"sources":["c:\\Users\\yangzhuo_sx\\Desktop\\GDOM\\GDOM\\gdom\\src\\components\\accountManage\\accountManage.js"],"names":["React","Component","Tag","Button","Input","Alert","ajaxParam","ajax","qs","accountManage","state","uid","name","cno","mobile","isError","code","oldPwd","newPwd","isShowChangeMobile","isShowChangePwd","componentWillMount","setState","props","componentDidMount","dataKey","data","reqResult","stringify","then","res","userInfo","username","catch","err","console","log","setMobile","e","preventDefault","target","value","setCode","setOldPwd","setNewPwd","showChangeMobile","prevState","showChangePwd","changePwd","status","alert","changeMobile","getCode","render","width"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { Tag, Button, Input, Alert } from 'antd';\r\nimport './accountManage.css';\r\nimport ajaxParam from '../../api/ajaxParam';\r\nimport ajax from '../../api/ajax';\r\nimport qs from 'qs';\r\n// import { format } from 'url';\r\n\r\nexport class accountManage extends Component {\r\n  state = {\r\n    uid: '',\r\n    name: '',\r\n    cno: '',\r\n    mobile: '',\r\n    isError: false,\r\n    code: '',\r\n    oldPwd: '',\r\n    newPwd: '',\r\n    isShowChangeMobile: false,\r\n    isShowChangePwd: false,\r\n  }\r\n\r\n\r\n  componentWillMount = () => {\r\n    this.setState({ uid: this.props.uid });\r\n  }\r\n\r\n  // /user/selfinfo\r\n  componentDidMount = () => {\r\n    const { uid, dataKey } = this.state;\r\n    const data = { \"uid\": uid };\r\n    const reqResult = (data) => ajaxParam('http://47.94.103.140/gdom/user/selfinfo', qs.stringify(data), 'post');\r\n    reqResult(data).then(res => {\r\n      const data = res.data\r\n      this.setState({ name: data.userInfo.username, mobile:data.userInfo.mobile})\r\n    }).catch(err => {\r\n      console.log(err);\r\n    })\r\n  }\r\n\r\n  // 获取用户输入的手机号\r\n  setMobile = (e) => {\r\n    e.preventDefault();\r\n    this.setState({ mobile: e.target.value });\r\n  };\r\n\r\n  // 获取用户收入的验证码\r\n  setCode = (e) => {\r\n    e.preventDefault();\r\n    this.setState({ code: e.target.value });\r\n  }\r\n\r\n  setOldPwd = (e) => {\r\n    e.preventDefault();\r\n    this.setState({ oldPwd: e.target.value });\r\n  }\r\n\r\n  setNewPwd = (e) => {\r\n    e.preventDefault();\r\n    this.setState({ newPwd: e.target.value });\r\n  }\r\n\r\n  // 点击修改或者绑定手机号时显示对应的模块\r\n  showChangeMobile = () => {\r\n    this.setState(prevState => ({ isShowChangeMobile: !prevState.isShowChangeMobile }))\r\n  }\r\n\r\n  // 点击密码重置时显示对应的模块\r\n  showChangePwd = () => {\r\n    this.setState(prevState => ({ isShowChangePwd: !prevState.isShowChangePwd }))\r\n  }\r\n\r\n  // 点击提交重置密码时的事件，请求ajax，传递参数\r\n  changePwd = () => {\r\n    const uid = this.state.uid;\r\n    const oldPwd = this.state.oldPwd;\r\n    const newPwd = this.state.newPwd;\r\n    const data = { \"uid\": uid, \"oldpwd\": oldPwd, \"newpwd\": newPwd };\r\n    const reqResult = (data) => ajaxParam('http://47.94.103.140/gdom/user/resetpwd', qs.stringify(data), 'post');\r\n    reqResult(data).then(res => {\r\n      if (res.status === 200) {\r\n        alert('重置成功');\r\n      } else {\r\n        alert('重置失败');\r\n      }\r\n      // console.log(res)\r\n    }).catch(err => {\r\n      console.log(err);\r\n    })\r\n  }\r\n\r\n  // 重置手机号\r\n  changeMobile = () => {\r\n    const uid = this.state.uid;\r\n    const code = this.state.code;\r\n    const mobile = this.state.mobile;\r\n    const data = { \"uid\": uid, \"mobile\": mobile, \"code\": code };\r\n    const reqResult = (data) => ajaxParam('http://47.94.103.140/gdom/user/bindmobile', qs.stringify(data), 'post');\r\n    reqResult(data).then(res => {\r\n      // console.log(res)\r\n      alert(res.data);\r\n    }).catch(err => {\r\n      console.log(err);\r\n    })\r\n  };\r\n\r\n  // 获取验证码 \r\n  getCode = () => {\r\n    const mobile = this.state.mobile;\r\n    // 请求获取短信验证码的接口\r\n    const data = { \"mobile\": mobile };\r\n    const reqResult = (data) => ajax('http://47.94.103.140/gdom/login/message', qs.stringify(data), 'post');\r\n    reqResult(data).then(res => {\r\n      if (res.data === 'success') {\r\n        // console.log(res)\r\n      }\r\n    }).catch(err => {\r\n      console.log(err);\r\n    })\r\n    console.log(\"短信验证\");\r\n  };\r\n\r\n  render() {\r\n    const { name, cno, mobile, isShowChangeMobile, isError, isShowChangePwd } = this.state;\r\n    return (\r\n      <div className=\"content\">\r\n        <div className=\"name-con\">\r\n          <div className=\"name\">姓名：{name}</div>\r\n          {/* <div className=\"cno\">学号：{cno}</div> */}\r\n        </div>\r\n        <div className=\"telephone\">\r\n          <span>手机号：{mobile ? mobile : '未绑定手机号'}</span>\r\n          <Button onClick={this.showChangeMobile}>{mobile ? '修改' : '绑定'}</Button>\r\n        </div>\r\n        {isShowChangeMobile ? <div className=\"change-mobile\">\r\n          <Input placeholder=\"请输入手机号...\" className=\"InpNumber\" onChange={this.setMobile} />\r\n          <div className=\"getCode\">\r\n            <Input placeholder=\"请输入验证码\" className=\"Inp\" size={'large'} onChange={this.setCode} />\r\n            <Button type=\"primary\" ref=\"but\" className=\"btn-pwd\" size={'large'} onClick={this.getCode}>获取短信验证码</Button>\r\n          </div>\r\n          <Button type=\"primary\" onClick={this.changeMobile} style={{ width: \"300px\" }} size={'large'}>重置手机号</Button>\r\n          {isError ? <Alert\r\n            message=\"Error\"\r\n            description=\"验证失败，请重新验证\"\r\n            type=\"error\"\r\n            showIcon\r\n          /> : null}\r\n        </div> : null}\r\n\r\n        <Button type=\"primary\" size={'large'} onClick={this.showChangePwd}>密码重置</Button>\r\n        {isShowChangePwd ? <div className=\"change-pwd\">\r\n          <Input.Password placeholder=\"请输入旧密码...\" onChange={this.setOldPwd} />\r\n          <Input.Password placeholder=\"请输入新密码...\" className='inp-pwd' onChange={this.setNewPwd} />\r\n          <Button type=\"primary\" size={'large'} onClick={this.changePwd}>重置密码</Button>\r\n        </div> : null}\r\n\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default accountManage\r\n"]},"metadata":{},"sourceType":"module"}